import React, { useState } from 'react'
import { useDispatch, useSelector } from 'react-redux';
import { useNavigate } from 'react-router-dom';
import { useRefresh } from '../../hooks/useRefresh';
import { getCourseByCodeThunk, joinCourseThunk } from '../../redux/user/thunk';
import { StyledContainer } from '../../style/components/StyledContainer';
import { StyledWrapper } from '../../style/components/StyledWrapper';
import { StyledHeading } from '../../style/components/StyledHeading';
import { grey, lightblue } from '../../style/ColorVariable';
import { NavBarSiswa } from '../partials/NavBarSiswa';
import { StyledInput } from '../../style/components/StyledInput';
import { CourseCard } from '../partials/CourseCard';
import { Modal } from '../partials/Modal';

export const CariCourse = () => {

    const [code, setCode] = useState('')
    const [token, tokenExp] = useRefresh('siswa');
    const [toggle, setToggle] = useState(false);

    const course = useSelector(state => state.user.course);
    const navigate = useNavigate();
    const dispatch = useDispatch();

    const { coursedetail, joint, materi, exercise } = course;

    const body = {
        idcourse: coursedetail && coursedetail.id_course
    }

    const post = () => {
        dispatch(joinCourseThunk(body, token, tokenExp));
        navigate('/dashboard-siswa', { replace: true });
    }

    const get = (e) => {
        e.preventDefault();
        dispatch(getCourseByCodeThunk(token, tokenExp, code));
    }

    const toggler = () => {
        setToggle(!toggle);
    }

    return (
        <StyledContainer flex="flex">
            <NavBarSiswa />
            <StyledWrapper>
                <StyledHeading backgroundcolor={lightblue}>
                    Cari Course
                </StyledHeading>
                <div className='m-t-20'>
                    <div>
                        <form onSubmit={get}>
                            <div>
                                <label htmlFor="code">Masukan Code Course</label>
                            </div>
                            <div className='flex flex-center p-20-all w-90'>
                                <StyledInput
                                    type="text"
                                    id='code'
                                    value={code}
                                    name='code'
                                    onChange={e => setCode(e.target.value)}
                                    placeholder="Code Course"
                                    border={true}
                                />
                                <button className='src-btn'>Cari</button>
                            </div>
                        </form>
                    </div>
                </div>
                <div>
                    <div className='flex flex-wrap '>
                        {course[0] !== '' && coursedetail ?

                            <div>
                                <CourseCard
                                    bg={grey}
                                    judul={coursedetail.judul_course}
                                    deskripsi={coursedetail.deskripsi_course}
                                    id={course.id_course}
                                    url='/course-detail-guru/'
                                    btn={true}
                                    joint={joint}
                                    exercise={exercise}
                                    materi={materi}
                                    post={toggler}

                                />
                            </div>

                            :

                            <div className='flex flex-column flex-center p-10-all'>
                                <svg width="400" height="400" viewBox="-70 100 900 500" fill="none" xmlns="http://www.w3.org/2000/svg"> <g clip-path="url(#clip0)"> <path d="M490.67 43.01H29.8105C15.8211 43.01 4.48047 54.3506 4.48047 68.34V182.63C4.48047 196.619 15.8211 207.96 29.8105 207.96H490.67C504.66 207.96 516 196.619 516 182.63V68.34C516 54.3506 504.66 43.01 490.67 43.01Z" fill="white" /> <path d="M516.002 146.25V198.08C516.002 203.54 505.002 207.96 491.512 207.96H29.0017C15.4717 207.96 4.51172 203.54 4.51172 198.08V168.08C35.6917 176.34 71.1917 181.91 107.602 185.37C151.602 189.55 196.952 190.77 242.112 190.95C296.112 191.17 351.012 189.86 401.842 182.53C448.422 175.83 491.612 163.48 516.002 146.25Z" fill="#E8F0F9" /> <path d="M490.19 212.15H29.33C21.5554 212.142 14.1013 209.051 8.60286 203.554C3.10442 198.058 0.0105881 190.605 0 182.83L0 68.53C0.0105881 60.7553 3.10442 53.3023 8.60286 47.8058C14.1013 42.3092 21.5554 39.2179 29.33 39.21H490.19C497.966 39.2179 505.422 42.3106 510.921 47.8093C516.419 53.308 519.512 60.7636 519.52 68.54V182.84C519.507 190.613 516.412 198.063 510.914 203.558C505.415 209.052 497.963 212.142 490.19 212.15ZM29.33 47.21C23.6763 47.2153 18.2555 49.4628 14.2568 53.4597C10.2581 57.4565 8.00794 62.8763 8 68.53V182.83C8.0053 188.485 10.2543 193.908 14.2533 197.907C18.2523 201.906 23.6746 204.155 29.33 204.16H490.19C495.845 204.155 501.268 201.906 505.267 197.907C509.266 193.908 511.515 188.485 511.52 182.83V68.53C511.515 62.8745 509.266 57.4522 505.267 53.4532C501.268 49.4542 495.845 47.2053 490.19 47.2L29.33 47.21Z" fill="#314E5D" /> <path d="M721.671 299.01H194.881C180.891 299.01 169.551 310.351 169.551 324.34V438.63C169.551 452.619 180.891 463.96 194.881 463.96H721.671C735.66 463.96 747.001 452.619 747.001 438.63V324.34C747.001 310.351 735.66 299.01 721.671 299.01Z" fill="white" /> <path d="M747.001 402.25V454.08C747.001 459.54 734.621 463.96 719.351 463.96H197.201C181.931 463.96 169.551 459.54 169.551 454.08V424.08C204.751 432.34 244.831 437.91 285.931 441.37C335.551 445.55 386.791 446.77 437.781 446.95C498.721 447.17 560.721 445.86 618.101 438.53C670.711 431.83 719.471 419.48 747.001 402.25Z" fill="#E8F0F9" /> <path d="M378.319 299.42C323.919 302.68 248.319 299.53 201.409 311.52C179.139 317.2 173.649 328.22 170.059 337.33L170.129 311.82C170.129 308.55 170.439 304.99 176.349 302.49C183.659 299.41 196.489 299.17 207.789 299.18C263.269 299.2 323.939 297 378.319 299.42Z" fill="#4ED9FF" /> <path d="M721.13 468.15H194.33C186.555 468.142 179.101 465.051 173.603 459.554C168.104 454.058 165.011 446.605 165 438.83V324.53C165.008 316.754 168.101 309.298 173.599 303.799C179.098 298.301 186.554 295.208 194.33 295.2H721.13C728.906 295.208 736.362 298.301 741.861 303.799C747.359 309.298 750.452 316.754 750.46 324.53V438.83C750.449 446.605 747.356 454.058 741.857 459.554C736.359 465.051 728.905 468.142 721.13 468.15ZM194.33 303.21C188.676 303.215 183.256 305.463 179.257 309.46C175.258 313.456 173.008 318.876 173 324.53V438.83C173.005 444.485 175.254 449.908 179.253 453.907C183.252 457.906 188.675 460.155 194.33 460.16H721.13C726.785 460.155 732.208 457.906 736.207 453.907C740.206 449.908 742.455 444.485 742.46 438.83V324.53C742.455 318.874 740.206 313.452 736.207 309.453C732.208 305.454 726.785 303.205 721.13 303.2L194.33 303.21Z" fill="#314E5D" /> <path d="M648.448 3.38H121.728C107.739 3.38 96.3984 14.7206 96.3984 28.71V498.9C96.3984 512.889 107.739 524.23 121.728 524.23H648.448C662.438 524.23 673.778 512.889 673.778 498.9V28.71C673.778 14.7206 662.438 3.38 648.448 3.38Z" fill="#1DCDFF" /> <path d="M673.782 329.38V493C673.782 510.23 661.402 524.19 646.132 524.19H124.002C108.732 524.19 96.3516 510.19 96.3516 493V398.38C131.552 424.46 171.622 442.06 212.712 452.99C262.332 466.2 313.562 470.06 364.542 470.62C425.482 471.31 487.462 467.17 544.842 444.02C597.502 422.8 646.262 383.78 673.782 329.38Z" fill="#1AB5E1" /> <path d="M305.152 4.69002C250.762 15 175.212 5.05002 128.262 42.89C106.002 60.83 100.512 95.62 96.9219 124.39L97.0019 43.86C97.0019 33.55 97.3119 22.28 103.222 14.41C110.532 4.69002 123.362 3.94002 134.652 3.94002C190.112 4.00002 250.772 -2.81998 305.152 4.69002Z" fill="#4ED9FF" /> <path d="M647.912 528.85H121.182C113.405 528.842 105.95 525.749 100.451 520.251C94.9522 514.752 91.8595 507.296 91.8516 499.52V29.33C91.8595 21.5536 94.9522 14.0981 100.451 8.59933C105.95 3.10061 113.405 0.00794182 121.182 0L647.912 0C655.688 0.00794182 663.144 3.10061 668.642 8.59933C674.141 14.0981 677.234 21.5536 677.242 29.33V499.53C677.231 507.305 674.137 514.758 668.639 520.254C663.14 525.751 655.686 528.842 647.912 528.85ZM121.182 8C115.526 8.0053 110.104 10.2543 106.105 14.2533C102.106 18.2523 99.8569 23.6746 99.8516 29.33V499.53C99.8569 505.185 102.106 510.608 106.105 514.607C110.104 518.606 115.526 520.855 121.182 520.86H647.912C653.567 520.855 658.989 518.606 662.988 514.607C666.987 510.608 669.236 505.185 669.242 499.53V29.33C669.236 23.6746 666.987 18.2523 662.988 14.2533C658.989 10.2543 653.567 8.0053 647.912 8H121.182Z" fill="#314E5D" /> <path d="M607.971 36.96H164.551C155.792 36.96 148.691 44.0607 148.691 52.82V469.57C148.691 478.329 155.792 485.43 164.551 485.43H607.971C616.731 485.43 623.831 478.329 623.831 469.57V52.82C623.831 44.0607 616.731 36.96 607.971 36.96Z" fill="white" /> <path d="M623.068 49.68V136.76H147.898V49.68C147.898 43 154.698 37.58 163.088 37.58H607.878C616.268 37.58 623.068 43 623.068 49.68Z" fill="#DCEAEF" /> <path d="M607.401 491.92H164.001C158.735 491.915 153.687 489.821 149.963 486.097C146.24 482.374 144.146 477.326 144.141 472.06V52.06C144.149 46.7961 146.244 41.7503 149.967 38.0291C153.69 34.308 158.737 32.2153 164.001 32.21H607.401C612.666 32.2153 617.715 34.3093 621.438 38.0327C625.161 41.756 627.255 46.8044 627.261 52.07V472.07C627.253 477.334 625.157 482.38 621.434 486.101C617.711 489.822 612.664 491.915 607.401 491.92ZM164.001 40.21C160.857 40.2152 157.843 41.4665 155.62 43.6895C153.397 45.9126 152.146 48.9261 152.141 52.07V472.07C152.149 475.212 153.401 478.223 155.624 480.444C157.846 482.665 160.859 483.915 164.001 483.92H607.401C610.544 483.915 613.558 482.663 615.781 480.44C618.004 478.217 619.255 475.204 619.261 472.06V52.06C619.253 48.9179 618 45.9069 615.778 43.686C613.555 41.4651 610.543 40.2152 607.401 40.21H164.001Z" fill="#314E5D" /> <path d="M403.602 95.59H201.512V113.05H403.602V95.59Z" fill="white" /> <path d="M195.208 179.73H294.078V175.58H195.208V179.73Z" fill="#CED5D8" /> <path d="M195.208 188.87L410.398 188.87V184.72L195.208 184.72V188.87Z" fill="#CED5D8" /> <path d="M195.208 198.01H294.078V193.86H195.208V198.01Z" fill="#CED5D8" /> <path d="M195.208 207.15L410.398 207.15V203L195.208 203V207.15Z" fill="#CED5D8" /> <path d="M195.208 216.29H294.078V212.14H195.208V216.29Z" fill="#CED5D8" /> <path d="M195.208 225.42L410.398 225.42V221.27L195.208 221.27V225.42Z" fill="#CED5D8" /> <path d="M195.208 262.32H294.078V258.17H195.208V262.32Z" fill="#CED5D8" /> <path d="M195.208 271.46H410.398V267.31H195.208V271.46Z" fill="#CED5D8" /> <path d="M195.208 280.6H294.078V276.45H195.208V280.6Z" fill="#CED5D8" /> <path d="M195.208 289.74H410.398V285.59H195.208V289.74Z" fill="#CED5D8" /> <path d="M195.208 298.88H294.078V294.73H195.208V298.88Z" fill="#CED5D8" /> <path d="M195.208 308.01H410.398V303.86H195.208V308.01Z" fill="#CED5D8" /> <path d="M195.208 344.91H294.078V340.76H195.208V344.91Z" fill="#CED5D8" /> <path d="M195.208 354.05H410.398V349.9H195.208V354.05Z" fill="#CED5D8" /> <path d="M195.208 363.19H294.078V359.04H195.208V363.19Z" fill="#CED5D8" /> <path d="M195.208 372.33H410.398V368.18H195.208V372.33Z" fill="#CED5D8" /> <path d="M195.208 381.47H294.078V377.32H195.208V381.47Z" fill="#CED5D8" /> <path d="M195.208 390.6H410.398V386.45H195.208V390.6Z" fill="#CED5D8" /> <path d="M528.96 64.92L603.18 64.92V56.19L528.96 56.19V64.92Z" fill="#EEA248" /> <path d="M444.499 64.92L518.719 64.92V56.19L444.499 56.19V64.92Z" fill="#EEA248" /> <path d="M171.51 68.97C176.16 68.97 179.93 65.2002 179.93 60.55C179.93 55.8998 176.16 52.13 171.51 52.13C166.86 52.13 163.09 55.8998 163.09 60.55C163.09 65.2002 166.86 68.97 171.51 68.97Z" fill="#EEA248" /> <path d="M469.184 376.239L442.336 401.699L496.813 459.146L523.661 433.686L469.184 376.239Z" fill="#314E5D" /> <g opacity="0.5"> <path opacity="0.5" d="M445.892 377.148C480.882 343.968 482.348 288.706 449.168 253.716C415.988 218.727 360.725 217.261 325.736 250.441C290.747 283.621 289.281 338.884 322.461 373.873C355.641 408.862 410.903 410.328 445.892 377.148Z" fill="#8BDDEB" /> <path opacity="0.5" d="M339.8 364.25C330.97 354.944 324.301 343.806 320.267 331.628C316.233 319.45 314.933 306.533 316.461 293.796C317.989 281.059 322.306 268.815 329.106 257.937C335.905 247.059 345.02 237.814 355.8 230.86C344.265 235.087 333.752 241.701 324.948 250.269C316.144 258.837 309.247 269.166 304.709 280.582C300.17 291.998 298.091 304.243 298.609 316.517C299.126 328.791 302.228 340.817 307.712 351.811C313.195 362.804 320.937 372.516 330.431 380.313C339.925 388.109 350.957 393.815 362.807 397.056C374.657 400.297 387.057 401.001 399.197 399.121C411.338 397.242 422.945 392.822 433.26 386.15C417.245 392.028 399.86 393.086 383.251 389.194C366.641 385.302 351.536 376.631 339.8 364.25Z" fill="#62D6F8" /> </g> <path d="M481.098 220.58C471.584 210.523 460.57 201.999 448.448 195.31C448.238 195.18 448.028 195.07 447.798 194.96C419.775 179.699 387.238 174.901 356.002 181.425C324.767 187.949 296.869 205.368 277.297 230.57C257.724 255.771 247.752 287.112 249.163 318.99C250.574 350.869 263.276 381.206 284.998 404.58C285.308 404.93 285.628 405.27 285.998 405.58C295.931 416.08 307.497 424.904 320.248 431.71L320.608 431.9C348.788 446.805 381.346 451.213 412.474 444.338C443.602 437.462 471.274 419.752 490.555 394.365C509.835 368.978 519.469 337.567 517.737 305.736C516.004 273.905 503.02 243.725 481.098 220.58ZM448.208 253.72C460.092 266.25 467.992 282.021 470.912 299.041C473.831 316.061 471.638 333.564 464.609 349.338C457.581 365.111 446.033 378.446 431.426 387.656C416.819 396.867 399.808 401.538 382.546 401.081C365.284 400.624 348.545 395.058 334.446 385.087C320.347 375.116 309.521 361.189 303.338 345.065C297.154 328.942 295.891 311.347 299.707 294.506C303.524 277.664 312.249 262.333 324.778 250.45C333.098 242.56 342.89 236.386 353.596 232.28C364.301 228.175 375.711 226.218 387.173 226.523C398.635 226.828 409.924 229.387 420.397 234.055C430.869 238.724 440.32 245.409 448.208 253.73V253.72Z" fill="#E7E7E7" /> <path d="M490.531 391.42C467.7 413.073 437.997 426.033 406.596 428.044C375.194 430.054 344.081 420.988 318.675 402.424C293.269 383.86 275.178 356.973 267.552 326.445C259.926 295.917 263.249 263.681 276.941 235.35C265.872 250.416 258.067 267.625 254.023 285.877C249.979 304.13 249.786 323.025 253.455 341.356C257.125 359.688 264.576 377.053 275.334 392.342C286.092 407.632 299.92 420.511 315.934 430.156C331.949 439.801 349.799 446.001 368.345 448.359C386.891 450.718 405.725 449.183 423.644 443.854C441.563 438.524 458.174 429.517 472.417 417.407C486.659 405.296 498.22 390.349 506.361 373.52C501.623 379.942 496.325 385.932 490.531 391.42Z" fill="#CED0D0" /> <path d="M384.659 452.27C361.637 452.281 338.981 446.512 318.769 435.49L318.269 435.22C288.915 419.07 266.385 392.857 254.829 361.41C254.569 360.73 254.319 360.02 254.089 359.29C244.961 333.025 243.95 304.621 251.19 277.774C258.43 250.927 273.583 226.881 294.679 208.766C315.775 190.652 341.835 179.308 369.468 176.21C397.101 173.113 425.026 178.406 449.609 191.4C449.879 191.53 450.149 191.68 450.409 191.83C476.287 205.742 497.069 227.524 509.749 254.027C522.43 280.53 526.353 310.379 520.949 339.258C515.546 368.137 501.097 394.549 479.692 414.674C458.287 434.8 431.036 447.595 401.879 451.21C396.166 451.914 390.415 452.268 384.659 452.27ZM384.889 183.27C364.063 183.277 343.541 188.267 325.037 197.823C306.533 207.379 290.584 221.224 278.521 238.201C266.459 255.178 258.633 274.794 255.698 295.412C252.763 316.03 254.803 337.051 261.649 356.72V356.84C261.839 357.44 262.059 358.04 262.279 358.63C273.168 388.293 294.419 413.017 322.109 428.24L322.459 428.43C349.759 443.363 381.499 448.046 411.949 441.633C442.398 435.219 469.552 418.132 488.51 393.455C507.467 368.779 516.979 338.138 515.329 307.064C513.678 275.99 500.974 246.53 479.509 224C469.947 213.889 458.822 205.38 446.559 198.8L446.409 198.71L446.089 198.54L445.939 198.46C427.135 188.491 406.173 183.286 384.889 183.3V183.27ZM384.889 405.08C384.059 405.08 383.239 405.08 382.409 405.08C358.331 404.753 335.36 394.916 318.507 377.716C301.654 360.516 292.288 337.348 292.451 313.268C292.615 289.189 302.295 266.151 319.381 249.181C336.466 232.212 359.569 222.688 383.649 222.688C407.729 222.688 430.832 232.212 447.918 249.181C465.003 266.151 474.683 289.189 474.847 313.268C475.011 337.348 465.644 360.516 448.791 377.716C431.939 394.916 408.967 404.753 384.889 405.08ZM384.779 230.46C363.457 230.416 342.94 238.605 327.509 253.32C313.526 266.581 304.574 284.281 302.178 303.403C299.782 322.524 304.089 341.886 314.367 358.187C324.646 374.489 340.258 386.723 358.545 392.804C376.831 398.886 396.661 398.438 414.655 391.539C432.649 384.639 447.694 371.714 457.226 354.966C466.759 338.217 470.19 318.682 466.934 299.687C463.678 280.693 453.937 263.415 439.371 250.797C424.804 238.18 406.314 231.003 387.049 230.49C386.309 230.49 385.562 230.49 384.809 230.49L384.779 230.46Z" fill="#314E5D" /> <path d="M490.644 423.417L490.636 423.424C479.239 434.232 478.762 452.233 489.57 463.63L570.428 548.897C581.236 560.294 599.237 560.772 610.634 549.964L610.642 549.957C622.039 539.149 622.517 521.148 611.709 509.751L530.85 424.484C520.042 413.087 502.041 412.609 490.644 423.417Z" fill="#426372" /> <path d="M589.889 561.75H588.999C584.741 561.655 580.544 560.715 576.651 558.987C572.758 557.258 569.246 554.775 566.319 551.68L485.469 466.4C482.537 463.309 480.243 459.67 478.718 455.692C477.192 451.714 476.465 447.475 476.578 443.216C476.691 438.957 477.641 434.762 479.375 430.87C481.109 426.979 483.593 423.467 486.684 420.535C489.776 417.603 493.414 415.309 497.392 413.784C501.37 412.258 505.609 411.531 509.868 411.644C514.127 411.756 518.322 412.707 522.214 414.441C526.106 416.175 529.617 418.659 532.549 421.75L613.409 507C619.309 513.253 622.493 521.588 622.264 530.182C622.035 538.776 618.413 546.929 612.189 552.86C606.18 558.588 598.191 561.773 589.889 561.75ZM508.999 419.65C504.226 419.661 499.561 421.068 495.578 423.698C491.595 426.328 488.469 430.066 486.584 434.451C484.7 438.836 484.139 443.676 484.971 448.376C485.804 453.076 487.993 457.429 491.269 460.9L572.119 546.16C576.592 550.845 582.735 553.571 589.21 553.743C595.684 553.916 601.964 551.52 606.679 547.08C611.364 542.608 614.09 536.464 614.262 529.99C614.435 523.515 612.039 517.235 607.599 512.52L526.749 427.26C524.465 424.85 521.712 422.931 518.66 421.623C515.608 420.314 512.32 419.643 508.999 419.65Z" fill="#314E5D" /> <g opacity="0.5"> <path opacity="0.5" d="M517.9 434.08C527.9 442.48 535.63 452.93 544.97 461.97C547.75 464.66 551.97 460.42 549.21 457.73C539.87 448.73 532.14 438.24 522.14 429.84C519.2 427.37 514.94 431.59 517.9 434.08Z" fill="white" /> <path opacity="0.5" d="M500.642 432.19C502.244 431.198 504.045 430.57 505.916 430.352C507.788 430.135 509.685 430.332 511.472 430.93C515.182 432.01 516.772 426.22 513.072 425.14C510.511 424.332 507.807 424.08 505.141 424.401C502.475 424.722 499.908 425.608 497.612 427C494.302 429 497.312 434.17 500.612 432.18L500.642 432.19Z" fill="white" /> </g> <path d="M418.051 204.15C434.001 209 449.001 216.76 461.461 227.83C477.281 241.83 488.041 260.21 494.621 280.17C495.821 283.82 501.621 282.26 500.411 278.57C493.521 257.67 482.281 238.28 465.711 223.57C452.431 211.79 436.571 203.57 419.661 198.35C415.961 197.22 414.381 203.01 418.061 204.14L418.051 204.15Z" fill="white" /> <path d="M359.78 198.58C370.21 197.2 381.02 197.71 391.44 198.77C395.28 199.16 395.25 193.16 391.44 192.77C381.02 191.71 370.21 191.2 359.78 192.58C356.01 193.08 355.96 199.09 359.78 198.58Z" fill="white" /> </g> <defs> <clipPath id="clip0"> <rect width="750.45" height="561.75" fill="white" /> </clipPath></defs></svg>
                            </div>
                        }
                    </div>
                </div>
                {
                    toggle &&

                    <Modal
                        ask='Join Course?'
                        toggle={toggler}
                        onClick={post}
                    />

                }
            </StyledWrapper>
        </StyledContainer >

    )
}